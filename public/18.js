(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{99:function(t,e,o){"use strict";o.r(e);var n=o(1),r=o.n(n);function a(t,e,o,n,r,a,s){try{var c=t[a](s),i=c.value}catch(t){return void o(t)}c.done?e(i):Promise.resolve(i).then(n,r)}function s(t){return function(){var e=this,o=arguments;return new Promise((function(n,r){var s=t.apply(e,o);function c(t){a(s,n,r,c,i,"next",t)}function i(t){a(s,n,r,c,i,"throw",t)}c(void 0)}))}}var c={props:{rawItemsReady:{type:Boolean}},components:{},data:function(){return{headers:[{text:"Code",align:"start",value:"id"},{text:"Product Name",align:"start",value:"name"},{text:"Actions",value:"actions",sortable:!1}],items:[],loading:!1,showForm:!1,deleteForm:!1,formData:{action:null,id:0,product_name:null},itemIndex:-1}},mounted:function(){this.getProducts()},methods:{showAddForm:function(){this.formData.action="add",this.formData.id=0,this.formData.product_name=null,this.itemIndex=-1,this.showForm=!0},showUpdateForm:function(t){this.formData.action="update",this.formData.id=t.id,this.formData.product_name=t.name,this.itemIndex=this.items.indexOf(t),this.showForm=!0},submitForm:function(){this.formData.product_name?(this.loading=!0,"add"==this.formData.action?this.processAdd():this.processUpdate(),this.showForm=!1):this.$store.commit("showSnackbar",{color:!1,text:"Product name is required."})},getProducts:function(){var t=this;return s(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,axios.post("/products/view").then((function(e){t.items=e.data.product})).catch((function(e){e.response&&(console.log(e.response),t.$store.commit("errorSnackbar"))}));case 3:t.loading=!1;case 4:case"end":return e.stop()}}),e)})))()},processAdd:function(){var t=this;return s(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.post("/products/add",{name:t.formData.product_name}).then((function(e){t.$store.commit("showSnackbar",{color:!0,text:"".concat(e.data.product.name," added.")}),console.log(e.data.product),t.items.push(e.data.product)})).catch((function(e){e.response&&(console.log(e.response),t.$store.commit("errorSnackbar"))}));case 2:t.loading=!1;case 3:case"end":return e.stop()}}),e)})))()},processUpdate:function(){var t=this;return s(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.post("/products/update",{id:t.formData.id,name:t.formData.product_name}).then((function(e){t.$store.commit("showSnackbar",{color:!0,text:"".concat(e.data.product.name," updated.")}),Object.assign(t.items[t.itemIndex],e.data.product)})).catch((function(e){e.response&&(console.log(e.response),t.$store.commit("errorSnackbar"))}));case 2:t.loading=!1;case 3:case"end":return e.stop()}}),e)})))()},processDelete:function(t){var e=this;return s(r.a.mark((function o(){return r.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!t.id){o.next=8;break}if(!confirm("Are you sure you want to delete ".concat(t.name))){o.next=6;break}return e.loading=!0,o.next=5,axios.post("/products/delete",{id:t.id}).then((function(o){e.$store.commit("showSnackbar",{color:!0,text:"".concat(o.data.product.name," deleted.")}),e.itemIndex=e.items.indexOf(t),e.items.splice(e.itemIndex,1),e.showForm=!1})).catch((function(t){t.response&&(console.log(t.response),e.$store.commit("errorSnackbar"))}));case 5:e.loading=!1;case 6:o.next=9;break;case 8:e.$store.commit("errorSnackbar");case 9:case"end":return o.stop()}}),o)})))()},productSelected:function(t){this.rawItemsReady?this.$emit("productselected",t):this.$store.commit("showSnackbar",{color:!1,text:"Raw items are still loading..."})}},computed:{customID:function(){return this.formData.id>0?"AP - ".concat(this.formData.id.toString().padStart(4,"0")):"N/A"}}},i=o(0),d=Object(i.a)(c,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-row",[o("v-col",{attrs:{sm:"10","offset-sm":"1"}},[o("v-card",{attrs:{flat:""}},[o("v-card-title",[t._v("\n                Products\n                "),o("v-btn",{staticClass:"ml-3",attrs:{text:"",outlined:"",color:"green darken-4"},on:{click:t.showAddForm}},[t._v("\n                    Add\n                ")])],1),t._v(" "),o("v-data-table",{attrs:{headers:t.headers,items:t.items,loading:t.loading},on:{"click:row":t.productSelected},scopedSlots:t._u([{key:"item.id",fn:function(e){var o=e.item;return[t._v("\n                    AP - "+t._s(o.id.toString().padStart(4,"0"))+"\n                ")]}},{key:"item.actions",fn:function(e){var n=e.item;return[o("v-btn",{attrs:{text:"",color:"blue darken-4"},on:{click:function(e){return e.stopPropagation(),t.showUpdateForm(n)}}},[t._v("Update")]),t._v(" "),o("v-btn",{attrs:{text:"",color:"red darken-4"},on:{click:function(e){return e.stopPropagation(),t.processDelete(n)}}},[t._v("Delete")])]}},t.showForm?{key:"body.prepend",fn:function(){return[o("tr",[o("td",[t._v("\n                            "+t._s(t.customID)+"\n                        ")]),t._v(" "),o("td",[o("v-text-field",{attrs:{autofocus:"",label:"Product Name"},model:{value:t.formData.product_name,callback:function(e){t.$set(t.formData,"product_name",e)},expression:"formData.product_name"}})],1),t._v(" "),o("td",[o("v-btn",{staticClass:"ml-1 my-1",attrs:{text:"",outlined:"",color:"green darken-4"},on:{click:function(e){return e.stopPropagation(),t.submitForm(e)}}},[t._v("\n                                Save\n                            ")]),t._v(" "),o("v-btn",{staticClass:"ml-1 my-1",attrs:{text:"",outlined:""},on:{click:function(e){e.stopPropagation(),t.showForm=!t.showForm}}},[t._v("\n                                Cancel\n                            ")])],1)])]},proxy:!0}:null],null,!0)})],1)],1)],1)}),[],!1,null,null,null);e.default=d.exports}}]);