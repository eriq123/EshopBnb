(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{84:function(t,e,o){"use strict";o.r(e);var n=o(1),a=o.n(n);o(21);function r(t,e,o,n,a,r,s){try{var i=t[r](s),c=i.value}catch(t){return void o(t)}i.done?e(c):Promise.resolve(c).then(n,a)}function s(t){return function(){var e=this,o=arguments;return new Promise((function(n,a){var s=t.apply(e,o);function i(t){r(s,n,a,i,c,"next",t)}function c(t){r(s,n,a,i,c,"throw",t)}i(void 0)}))}}var i={props:{user:{required:!0}},components:{"app-qr-menu":function(){return o.e(0).then(o.bind(null,95))},"app-qr-converted-units":function(){return o.e(1).then(o.bind(null,96))}},data:function(){return{backCamera:!0,drawOnFound:!0,stopOnScan:!0,eventDetail:null,dialog:{show:!1,title:null,disabled:!0,loading:!0,base_name:null,quantity:null},form:{id:0,type:null,quantity:null,action:null,status:null},convert:{collection:[],name:null,value:null},base:{collection:[]}}},methods:{processQRCode:function(){var t=this;"Products"==this.form.type?this.form.quantity=this.dialog.quantity:this.form.quantity=this.dialog.quantity*this.convert.value,this.dialog.show=!1,axios.post("/inventory/flow/store",this.form).then((function(e){console.log(e.data),t.$store.commit("showSnackbar",{color:!0,text:"Record has been updated!"})})).catch((function(e){e.response&&(console.log(e.response),e.response.data.error_message?t.$store.commit("showSnackbar",{color:!1,text:e.response.data.error_message}):t.$store.commit("errorSnackbar"))}))},qrScanned:function(t){this.eventDetail=t.detail[0];var e=this.eventDetail.split("-");"eshopbnb"==e[0]?(this.dialog.title="N/A","RI"==e[1]?(this.form.id=e[2],this.form.type="Raw item",user.is_admin?(this.form.action="minus",this.form.status="Purchase"):(this.form.action="add",this.form.status="Sold"),this.prepareRawDialog(e[2])):"AP"==e[1]?(this.form.id=e[2],this.form.type="Products",user.is_admin,this.form.action="minus",this.form.status="Sold",this.prepareProductDialog(e[2])):this.unknownQRCodeAlert()):this.unknownQRCodeAlert()},prepareRawDialog:function(t){var e=this;return s(a.a.mark((function o(){return a.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return e.dialog.show=e.dialog.loading=!0,o.next=3,axios.post("/home/raw",{id:t}).then((function(t){var o=t.data.raw;e.dialog.title="".concat(o.category.name," - ").concat(o.name),e.dialog.base_name=o.base.name,e.convert.collection=t.data.convert,e.convertNameAndValue()})).catch((function(t){t.response?(console.log(t.response),t.response.data.error?e.$store.commit("showSnackbar",{color:!1,text:t.response.data.error}):e.$store.commit("errorSnackbar")):console.log(t)}));case 3:e.dialog.loading=!1;case 4:case"end":return o.stop()}}),o)})))()},prepareProductDialog:function(t){var e=this;return s(a.a.mark((function o(){return a.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return e.dialog.show=e.dialog.loading=!0,o.next=3,axios.post("/home/product",{id:t}).then((function(t){console.log(t.data),e.dialog.title=t.data.product.name})).catch((function(t){t.response?(console.log(t.response),t.response.data.error?e.$store.commit("showSnackbar",{color:!1,text:t.response.data.error}):e.$store.commit("errorSnackbar")):console.log(t)}));case 3:e.dialog.loading=!1;case 4:case"end":return o.stop()}}),o)})))()},convertNameAndValue:function(){this.convert.collection.length>0?(this.convert.name=this.convert.collection[0].name,this.convert.value=this.convert.collection[0].value):(this.$store.commit("showSnackbar",{color:!1,text:"Sub-unit is required. Please add one then try again."}),this.dialog.show=!1)},unknownQRCodeAlert:function(){this.$store.commit("showSnackbar",{color:!1,text:"Unknown QR code. Please try again."})},selectedmenu:function(t){this.convert.name=t.name,this.convert.value=t.value},errorCaptured:function(t){switch(t.name){case"NotAllowedError":this.$store.commit("showSnackbar",{color:!1,text:"Camera permission denied."});break;case"NotFoundError":this.$store.commit("showSnackbar",{color:!1,text:"There is no connected camera."});break;case"NotSupportedError":this.$store.commit("showSnackbar",{color:!1,text:"Seems like this page is served in non-secure context."});break;case"NotReadableError":this.$store.commit("showSnackbar",{color:!1,text:"Couldn't access your camera. Is it already in use?"});break;case"OverconstrainedError":this.$store.commit("showSnackbar",{color:!1,text:"Constraints don't match any installed camera."});break;default:console.log(t),this.$store.commit("errorSnackbar")}console.log(t)}}},c=o(0),l=Object(c.a)(i,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-container",[o("v-row",[o("v-col",{attrs:{sm:"12",md:"8","offset-md":"2",lg:"4","offset-lg":"4"}},[o("vue-qr-reader",{attrs:{responsive:"true","use-back-camera":t.backCamera,"draw-on-found":t.drawOnFound,"stop-on-scan":t.stopOnScan},on:{"code-scanned":t.qrScanned,"error-captured":t.errorCaptured}})],1)],1),t._v(" "),o("v-dialog",{attrs:{"max-width":"450px"},model:{value:t.dialog.show,callback:function(e){t.$set(t.dialog,"show",e)},expression:"dialog.show"}},[o("v-card",[o("v-progress-linear",{attrs:{indeterminate:t.dialog.loading}}),t._v(" "),o("v-card-title",[o("span",{staticClass:"headline"},[t._v(t._s(this.dialog.title))])]),t._v(" "),o("v-card-text",["Products"==t.form.type?o("v-col",{attrs:{cols:"12"}},[o("v-text-field",{attrs:{type:"number",label:"Quantity"},model:{value:t.dialog.quantity,callback:function(e){t.$set(t.dialog,"quantity",e)},expression:"dialog.quantity"}})],1):t._e(),t._v(" "),"Raw item"==t.form.type?o("v-row",[o("v-col",{attrs:{cols:"10",offset:"1"}},[o("v-text-field",{attrs:{type:"number",label:"Quantity",loading:t.dialog.loading},scopedSlots:t._u([{key:"append-outer",fn:function(){return[o("app-qr-menu",{attrs:{menu:t.convert.collection,selected:t.convert.name},on:{selectedmenu:t.selectedmenu}})]},proxy:!0}],null,!1,4243591161),model:{value:t.dialog.quantity,callback:function(e){t.$set(t.dialog,"quantity",e)},expression:"dialog.quantity"}})],1),t._v(" "),o("v-col",{attrs:{cols:"10",offset:"1"}},[o("app-qr-converted-units",{attrs:{value:t.dialog.quantity,convertValue:t.convert.value,formDataBaseName:t.dialog.base_name}})],1)],1):t._e()],1),t._v(" "),o("v-card-actions",[o("v-spacer"),t._v(" "),o("v-btn",{attrs:{text:""},on:{click:function(e){t.dialog.show=!t.dialog.show}}},[t._v("Cancel")]),t._v(" "),o("v-btn",{attrs:{text:"",color:"green darken-3"},on:{click:t.processQRCode}},[t._v("Save")])],1)],1)],1)],1)}),[],!1,null,null,null);e.default=l.exports}}]);